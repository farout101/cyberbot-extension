(async function(){const t={url:window.location.href,isHttps:window.location.protocol==="https:",mixedContent:!1,scripts:[],cookies:[],securityHeaders:{},privacyPolicyLink:null};t.isHttps&&Array.from(document.querySelectorAll('[src^="http:"]')).length>0&&(t.mixedContent=!0),document.querySelectorAll("script[src]").forEach(e=>{t.scripts.push(e.src)});const o=document.querySelectorAll("a[href]");for(const e of o)if(/privacy/i.test(e.textContent)){t.privacyPolicyLink=e.href;break}t.cookies=document.cookie.split(";").map(e=>e.trim()).filter(Boolean);try{const e=await fetch(window.location.href,{method:"HEAD"});t.securityHeaders={csp:e.headers.get("content-security-policy"),hsts:e.headers.get("strict-transport-security"),xfo:e.headers.get("x-frame-options"),xcto:e.headers.get("x-content-type-options")}}catch(e){console.log("Could not fetch headers:",e)}chrome.runtime.sendMessage({type:"SECURITY_SCAN_RESULT",payload:t})})();
